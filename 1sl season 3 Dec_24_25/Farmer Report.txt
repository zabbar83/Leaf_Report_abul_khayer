select             vta.area_id areaId,
                   vta.area_name     areaName,
                   vta.zone_id zoneid,
                   vta.zone_name     zoneName,
                   vta.sub_area_id subAreaId,
                   vta.sub_area_name subAreaName,
                   vta.village_id villageId,
                   vta.village_name  villageName,
                   f.farmer_name farmerName,
                   f.farmer_reg_number farmerReg,
                   f.farmer_father_name fatherName,
                   coalesce(fc.land_acreage,0) acre,
                   fbc.account_number accountNumber,
                   b.bank_name || ', ' || bb.branch_name bankAndBranchName,
                   f.mobile_no mobileNo
from v_teritory_all vta
         join farmer f on vta.village_id=f.territory_id
    and  case when :areaId is not null then vta.area_id=:areaId else true end
    and  case when :zoneId is not null then vta.zone_id=:zoneId else true end
    and  case when :subAreaId is not null then vta.sub_area_id=:subAreaId else true end
    left join farmer_contact fc on f.id = fc.farmer_id
    and  fc.season_id=:seasonId
         left join farmer_bank_account fbc on f.id = fbc.farmer_id
         join bank_branch bb on fbc.bank_branch_id = bb.id
         join bank b on bb.bank_id = b.id
order by area_id,zone_id,sub_area_id,village_id